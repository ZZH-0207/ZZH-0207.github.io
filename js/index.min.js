/**
 * Blog JavaScript
 */
window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;document.addEventListener("DOMContentLoaded",function(){var zoomImgs=document.querySelectorAll(".entry-content img");zoomImgs&&zoomImgs.length>0&&loadScript("https://gw.alipayobjects.com/os/k/s3/lightense.min.js",function(){Lightense&&Lightense(zoomImgs,{background:"rgba(255, 255, 255, .8)"})});if(!isPC()){return}var beforeScrollTop=document.documentElement.scrollTop;document.addEventListener("scroll",function(){var afterScrollTop=document.documentElement.scrollTop;var delta=afterScrollTop-beforeScrollTop;document.getElementById("J_header").setAttribute("class",delta>0&&afterScrollTop>0?"header-menu header-menu-overflow":"header-menu");beforeScrollTop=afterScrollTop});
// Twinkling Stars Effect
var canvas=document.getElementById("J_firework_canvas");if(!canvas)return;var width=window.innerWidth;var height=260;canvas.width=width;canvas.height=height;var ctx=canvas.getContext("2d",{alpha:true});var stars=[];var starCount=Math.floor(width/15);// Responsive star count
var isAnimating=true;
// Pause animation when canvas is not visible
if("IntersectionObserver"in window){var observer=new IntersectionObserver(function(entries){entries.forEach(function(entry){isAnimating=entry.isIntersecting})},{threshold:0});observer.observe(canvas)}
// Star constructor
function Star(x,y,radius){this.x=x;this.y=y;this.radius=radius;this.alpha=Math.random();this.alphaChange=(Math.random()*.02+.005)*(Math.random()>.5?1:-1);this.color=this.getRandomColor()}Star.prototype.getRandomColor=function(){var colors=["rgba(255, 255, 255,",// White
"rgba(255, 250, 230,",// Warm white
"rgba(230, 240, 255,",// Cool white
"rgba(255, 220, 180,",// Orange tint
"rgba(200, 220, 255,"];return colors[Math.floor(Math.random()*colors.length)]};Star.prototype.draw=function(){ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fillStyle=this.color+this.alpha+")";ctx.fill();
// Add glow effect for brighter stars
if(this.alpha>.7&&this.radius>1){ctx.beginPath();ctx.arc(this.x,this.y,this.radius*2,0,Math.PI*2);ctx.fillStyle=this.color+this.alpha*.3+")";ctx.fill()}};Star.prototype.twinkle=function(){this.alpha+=this.alphaChange;if(this.alpha<=.1||this.alpha>=1){this.alphaChange=-this.alphaChange}};
// Initialize stars
for(var i=0;i<starCount;i++){var x=Math.random()*width;var y=Math.random()*height;var radius=Math.random()*1.5+.5;stars.push(new Star(x,y,radius))}
// Animation loop
function animate(){if(!isAnimating){requestAnimationFrame(animate);return}ctx.clearRect(0,0,width,height);for(var i=0;i<stars.length;i++){stars[i].twinkle();stars[i].draw()}requestAnimationFrame(animate)}
// Check for prefers-reduced-motion
var prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!prefersReducedMotion){animate()}else{
// Draw static stars for reduced motion preference
for(var i=0;i<stars.length;i++){stars[i].draw()}}
// Handle window resize
window.addEventListener("resize",function(){width=window.innerWidth;canvas.width=width;stars=[];starCount=Math.floor(width/15);for(var i=0;i<starCount;i++){var x=Math.random()*width;var y=Math.random()*height;var radius=Math.random()*1.5+.5;stars.push(new Star(x,y,radius))}});var qrTextEl=document.getElementById("J_qr_text");var isShowQr=qrTextEl&&qrTextEl.offsetParent;isShowQr&&loadScript("https://gw.alipayobjects.com/os/k/qa/qrcode.min.js",function(){QRCode&&new QRCode(document.getElementById("J_qr_code"),{width:128,height:128,useSVG:true,text:window.location.href,correctLevel:QRCode.CorrectLevel.L})})},false);function isPC(){var userAgentInfo=navigator.userAgent;var Agents=["Android","iPhone","Windows Phone","iPad","iPod"];var flag=true;for(var v=0;v<Agents.length;v++){if(userAgentInfo.indexOf(Agents[v])>0){flag=false;break}}return flag}function loadScript(url,callback){var script=document.createElement("script");script.type="text/javascript";if(script.readyState){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;callback()}}}else{script.onload=function(){callback()}}script.src=url;document.body.appendChild(script)}
